<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta http-equiv="x-dns-prefetch-control" content="on">
    <!-- 打开A标签的预解析 -->
    <title>通信类</title>
</head>
<body>
    <!--
        1.什么是同源策略及限制
         同源策略限制从一个源加载的文档或脚本如何与来自另一个源的资源进行交互。
         这是用于一个隔离潜在恶意文件的关键的安全机制。
         cookie localstrong indexDb不能用
         dom不能获取
         ajax不能发送请求
        2.前后端如何通信
        ajax websocket cors  
        3.如何创建Ajax
        4.跨域通信的几种方式
    -->
    <script type="text/javascript">
        // 简单版ajax
        function ajax ({url,type,data,dataType}) {
            return new Promise (function(open,err){
                // 1.创建xhr对象
                var xhr = new XMLHttpRequest();
                // 2.绑定监听事件
                xhr.onreadystatechange = function () {
                    if(xhr.readyState == 4 && xhr.status == 200) {
                        if(dataType !== undefined && dataType.toLowerCase() === "json")
                            var res = JSON.parse(xhr.responseText)
                        else
                            var res = xhr.responseText
                        open(res);
                    }
                }
                if(type.toLowerCase() == 'get' && data !== undefined){
                    url+='?'+data;
                }
                //3.打开连接
                xhr.open(type,url,true);
                if(type.toLowerCase() === 'post')
                    // 增加：设置请求消息头
                    xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded')
                //4.发送请求
                if(type.toLowerCase() == 'post' && data !== undefined)
                    xhr.send(data);
                else
                    xhr.send(null);
            })
        }
        // 1.创建xhr对象 判断是否为ie
        /*var xhr=window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Micrsoft.XMLHttp')
        // 2.绑定监听事件
        xhr.onreadystatechange = function () {
            if(xhr.readyState === 4 && xhr.status === 200){
                var result = xhr.responseText
                JSON.parse(reseult)
            }
        }
        // 3.打开连接
        xhr.open(methed,url,isAsyn); //false 同步 true 异步
        // 4.发送请求
        xhr.send(body);*/
    </script>
    <!--
        跨域通信的几种方式
        jsonp
        hash
        postMessage
        WebSocket
        CORS
    -->
    <script type="text/javascript">
        // 1 字面量创建
        var m = {A:'1'};
        var o1 = new Object({A:'1'});

        // 2通过构造函数
        function a(name){this.name=name}
        var o2=new a('tie');

        //3通过objectCreate创建
        var p = {name:'wang'};
        var o3 = Object.create(p);
    </script>
    <!--
        跨站请求伪造 CSRF
        跨域脚本攻击 XSS
        cors 浏览器会在请求头部上加一个origin
    -->
</body>
</html>